部分代码来自IdentityServer demo